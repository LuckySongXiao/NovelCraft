# NovelCraft 使用说明

## 快速开始

### 系统启动

#### 第一次使用
1. **安装依赖**: 双击 `Install-Dependencies.bat`
   - 自动检查Python和Node.js环境
   - 安装后端Python依赖包
   - 安装前端Node.js依赖包
   - 显示详细安装进度

2. **启动系统**: 双击 `Start-System.bat`
   - 自动环境检查和依赖验证
   - 启动后端API服务（端口8000）
   - 启动前端界面服务（端口3000）
   - 自动打开浏览器访问系统

#### 日常使用
- **启动**: 双击 `Start-System.bat`
- **停止**: 双击 `Stop-System.bat`

### 系统停止

- 双击运行 `Stop-System.bat` 安全停止所有服务
- 或在启动窗口按 `Ctrl+C` 停止服务

### 访问地址
- **前端界面**: http://localhost:3000
- **后端API**: http://localhost:8000
- **API文档**: http://localhost:8000/docs

## 系统要求

### 环境依赖
- **Python**: 3.9或更高版本
- **Node.js**: 16或更高版本
- **操作系统**: Windows 10/11（推荐）

### 推荐配置
- **内存**: 4GB以上
- **存储**: 2GB以上可用空间
- **网络**: 用于下载依赖和AI服务

## 主要功能模块

### 1. 项目管理
- **创建项目**: 新建小说项目，设置基本信息
- **项目列表**: 查看和管理所有项目
- **项目设置**: 修改项目配置和元数据
- **项目导入导出**: 备份和恢复项目数据

### 2. 人物管理
- **人物档案**: 创建详细的角色信息
- **属性设置**: 外貌、性格、背景等属性
- **关系管理**: 设定人物间的各种关系
- **成长轨迹**: 跟踪角色发展历程

### 3. 章节管理
- **章节创建**: 新建和编辑章节内容
- **状态跟踪**: 草稿、编辑中、已完成等状态
- **版本管理**: 保存章节的多个版本
- **字数统计**: 实时显示字数和进度

### 4. 世界设定
- **世界观**: 整体世界观和背景设定
- **地理设定**: 地图、地形、气候等
- **历史设定**: 重要历史事件和时期
- **文化设定**: 语言、习俗、宗教等

### 5. 势力管理
- **组织架构**: 势力的层级和结构
- **势力关系**: 联盟、敌对、中立等关系
- **影响范围**: 势力的地理和政治影响
- **重要成员**: 势力中的关键人物

### 6. 剧情管理
- **主线剧情**: 核心故事线的发展
- **支线剧情**: 次要情节和分支
- **剧情节点**: 重要转折点和高潮
- **冲突设定**: 各种矛盾和冲突

### 7. 修炼体系
- **等级设定**: 修炼境界和等级划分
- **修炼方法**: 功法、技能、修炼方式
- **能力体系**: 各种超自然能力设定
- **进阶条件**: 突破和提升的条件

### 8. 关系网络
- **关系图谱**: 可视化的人物关系网络
- **关系类型**: 亲情、友情、爱情、敌对等
- **关系强度**: 关系的紧密程度
- **关系变化**: 跟踪关系的发展变化

### 9. 时间线管理
- **事件时间轴**: 按时间顺序排列的事件
- **重要节点**: 标记关键时间点
- **时间线可视化**: 图形化显示时间进程
- **事件关联**: 事件间的因果关系

### 10. AI助手功能
- **智能对话**: 与AI进行创作相关的对话
- **内容生成**: AI辅助生成各种设定和内容
- **续写建议**: 基于已有内容的续写建议
- **一致性检查**: 检测内容中的逻辑矛盾

## AI功能详细使用

### AI配置设置
1. 进入 **系统设置** → **AI配置**
2. 选择AI提供商：
   - **Ollama**: 本地部署的开源模型（默认）
   - **OpenAI**: GPT-3.5、GPT-4等模型
   - **Claude**: Anthropic的Claude系列
   - **智谱AI**: 国产AI模型
   - **硅基流动**: 多种AI模型聚合
   - **Google AI**: Gemini系列模型
   - **Grok**: xAI的Grok模型
3. 填入配置信息（API Key、服务地址等）
4. 点击 **测试连接** 验证配置
5. 保存设置并切换到对应提供商

### 默认AI配置
系统已预配置Ollama作为默认AI提供商：
- **默认提供商**: Ollama
- **默认模型**: mollysama/rwkv-7-g1:0.4B
- **服务地址**: http://localhost:11434
- **优势**: 本地运行，无需API Key，数据隐私安全

### AI助手对话
1. 点击界面右下角的AI助手图标
2. 在对话框中输入问题或创作需求
3. AI会根据当前项目上下文提供专业建议
4. 支持多轮对话，保持上下文连贯性

### 内容生成功能
1. 在各个模块中找到"AI生成"按钮
2. 输入生成要求和关键词
3. 选择生成类型（人物、设定、剧情等）
4. AI生成内容后可以编辑和保存

### Ollama本地模型
- **自动检测**: 系统会自动检测本地安装的模型
- **模型选择**: 在配置界面选择要使用的模型
- **实时更新**: 支持动态刷新模型列表
- **离线使用**: 无需网络连接即可使用

## 操作流程指南

### 创建新项目
1. 在首页点击"新建项目"
2. 填写项目基本信息（名称、类型、简介）
3. 选择项目模板（可选）
4. 点击"创建"完成项目创建

### 设计世界观
1. 进入项目后，点击"设定管理" → "世界设定"
2. 创建世界观基础设定
3. 添加地理、历史、文化等详细设定
4. 使用AI助手生成更丰富的设定内容

### 创建人物
1. 点击"内容管理" → "人物管理"
2. 点击"新建人物"
3. 填写人物基本信息和详细属性
4. 设置人物关系和背景故事
5. 可使用AI生成人物设定

### 规划剧情
1. 进入"内容管理" → "剧情管理"
2. 创建主线和支线剧情
3. 设置剧情节点和转折点
4. 安排时间线和事件顺序

### 编写章节
1. 点击"内容管理" → "章节管理"
2. 创建新章节
3. 使用富文本编辑器编写内容
4. 设置章节状态和标签
5. 利用AI助手进行续写和优化

## 故障排除

### 启动问题
- **Python环境错误**:
  - 确保安装Python 3.9或更高版本
  - 检查Python是否添加到系统PATH
  - 重新运行 `Install-Dependencies.bat`

- **Node.js环境错误**:
  - 确保安装Node.js 16或更高版本
  - 检查npm是否正常工作
  - 清除npm缓存：`npm cache clean --force`

- **端口占用问题**:
  - 确保8000和3000端口未被其他程序占用
  - 使用 `Stop-System.bat` 清理相关进程
  - 重启计算机释放端口

### 功能问题
- **AI功能无法使用**:
  - 检查AI配置是否正确填写
  - 验证API Key是否有效
  - 测试网络连接是否正常
  - 查看AI服务商的使用限制

- **数据丢失问题**:
  - 数据保存在 `backend/novelcraft.db` 文件中
  - 定期备份数据库文件
  - 避免删除项目目录中的重要文件

- **界面显示异常**:
  - 刷新浏览器页面
  - 清除浏览器缓存
  - 重启系统服务
  - 检查浏览器兼容性

### 性能问题
- **启动缓慢**:
  - 首次启动需要安装依赖，耗时较长
  - 后续启动会明显加快
  - 确保网络连接稳定

- **响应缓慢**:
  - 检查系统资源使用情况
  - 关闭不必要的程序
  - 重启系统服务

- **内存占用高**:
  - 关闭多余的浏览器标签页
  - 定期重启系统
  - 检查是否有内存泄漏

## 数据管理

### 数据备份
- 定期备份 `backend/novelcraft.db` 数据库文件
- 备份整个项目目录以保存完整数据
- 使用版本控制系统管理项目文件

### 数据恢复
- 将备份的数据库文件替换当前文件
- 重启系统以加载恢复的数据
- 检查数据完整性和一致性

### 数据迁移
- 复制整个项目目录到新环境
- 重新运行 `Install-Dependencies.bat` 安装环境
- 使用 `Start-System.bat` 启动系统

## 技术支持

### 获取帮助
1. 查看本使用说明文档
2. 检查README.md中的详细信息
3. 查看启动窗口的错误信息
4. 联系技术支持团队

### 常用命令
- **重新安装依赖**: 双击 `Install-Dependencies.bat`
- **启动系统**: 双击 `Start-System.bat`
- **停止系统**: 双击 `Stop-System.bat`
- **查看日志**: 检查 `backend/logs/` 目录

---

**祝您使用愉快！如有问题请及时反馈。**
